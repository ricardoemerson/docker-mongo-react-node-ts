version: "3"

services:
    database:
        container_name: "mongodb"
        image: "mongo"
        environment:
            - MONGO_INITDB_DATABASE=${MONGO_INITDB_DATABASE}
            - MONGO_INITDB_ROOT_USERNAME=${MONGO_INITDB_ROOT_USERNAME}
            - MONGO_INITDB_ROOT_PASSWORD=${MONGO_INITDB_ROOT_PASSWORD}
        ports:
            - 27017-27017
        volumes:
            - ./data:/data/db
    server:
        build: ./packages/server
        container_name: "server"
        expose:
            - ${SERVER_PORT}
        ports:
            - ${SERVER_PORT}:${SERVER_PORT}
        volumes:
            - ./packages/server/src:/server/src
        links:
            - database
    web:
        build: ./packages/web
        container_name: "web"
        expose:
            - ${APP_PORT}
        ports:
            - ${APP_PORT}:${APP_PORT}
        volumes:
            - ./packages/web/src:/web/src
            - ./packages/web/public:/web/public
        links:
            - server
